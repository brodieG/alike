<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Brodie Gaslam" />


<title>alike</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,%2F%2A%0AStyles%20primarily%20borrowed%20from%20rmarkdown%2Ftemplates%2Fhtml%5Fvignette%2Fresources%2Fvignette%2Ecss%0Aat%20a%20time%2012%2F2%2F2014%20when%20rmarkdown%20was%20%28and%20probably%20still%20is%29%20under%20the%20GPL%2D3%0Alicense%0A%2A%2F%0A%0Abody%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E5%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20%2F%2Amargin%3A%200%200%2010px%2010px%3B%2A%2F%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20100%25%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%201em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23eee%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23eee%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%2C%20h1%20%3E%20code%2C%20h2%20%3E%20code%2C%20h3%20%3E%20code%2C%0Ah4%20%3E%20code%2C%20h5%20%3E%20code%2C%20h6%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%20%20line%2Dheight%3A%201%3B%0A%20%20font%2Dweight%3A%20bold%3B%0A%7D%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20padding%2Dbottom%3A%203px%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23999%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23999%3B%0A%20%20padding%2Dtop%3A%205px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20padding%2Dtop%3A%205px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20%2F%2Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%2A%2F%0A%20%20color%3A%20%23777%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah4%2Eauthor%2C%20h4%2Edate%20%7Bdisplay%3A%20none%3B%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20%2F%2Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%2A%2F%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%232255dd%3B%0A%20%20font%2Dweight%3A%20bold%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">alike</h1>
<h4 class="author"><em>Brodie Gaslam</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#templates">Templates</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#structure-wildcards">Structure Wildcards</a></li>
</ul></li>
<li><a href="#comparison-details">Comparison Details</a><ul>
<li><a href="#overview-1">Overview</a></li>
<li><a href="#length-comparison">Length Comparison</a></li>
<li><a href="#type-comparison">Type Comparison</a></li>
<li><a href="#attribute-comparison">Attribute Comparison</a></li>
</ul></li>
<li><a href="#objects-that-might-be-treated-differently-in-future">Objects That Might Be Treated Differently in Future</a></li>
<li><a href="#alike-as-an-s3-generic"><code>alike</code> as an S3 generic</a></li>
<li><a href="#performance-considerations">Performance Considerations</a><ul>
<li><a href="#overview-3">Overview</a></li>
<li><a href="#alike"><code>.alike</code></a></li>
<li><a href="#pre-defining-templates">Pre-defining Templates</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>alike</code> is similar to <code>all.equal</code> from base R, except it focuses on comparing object structure rather than actual values. A simple example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(alike)
<span class="kw">alike</span>(
  <span class="kw">matrix</span>(<span class="kw">integer</span>(), <span class="dt">ncol=</span><span class="dv">3</span>),
  <span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">nrow=</span><span class="dv">4</span>)
)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>The structure of these objects is the same: they are both integer matrices with three columns.</p>
<p><code>alike</code> was written to bring some of the guarantees about object structure that S4 provides to S3 objects. While the best way to achieve that objective is to use S4 classes, so much existing R code relies on S3 classes that a backstop approach is warranted.</p>
<p>To illustrate, suppose that we write a function that is intended to operate on a data frame with an <code>id</code> integer column and a <code>grade</code> factor column with possible levels <code>LETTERS[1:6]</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">my_fun &lt;-<span class="st"> </span>function(x) {
  df.tpl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span><span class="kw">integer</span>(), <span class="dt">grade=</span><span class="kw">factor</span>(<span class="dt">levels=</span>LETTERS[<span class="dv">1</span>:<span class="dv">6</span>]))
  if(!<span class="kw">isTRUE</span>(err &lt;-<span class="st"> </span><span class="kw">alike</span>(df.tpl, x)))
    <span class="kw">stop</span>(<span class="st">&quot;Argument `x` error: &quot;</span>, err)
  <span class="ot">TRUE</span>
}
df.correct &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span><span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">grade=</span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="dt">levels=</span>LETTERS[<span class="dv">1</span>:<span class="dv">6</span>]))
df.wrong &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span><span class="dv">4</span>:<span class="dv">6</span>, <span class="dt">grade=</span><span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">3</span>))

<span class="kw">my_fun</span>(df.correct)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_fun</span>(df.wrong)</code></pre>
<pre><code>## Error: Argument `x` error: Mismatch at column `grade`: length mismatch for
## attribute &quot;levels&quot;: expected 6, but got 1</code></pre>
<p>The rules governing what makes objects alike are complex to explain, but should be intuitive to understand. We recommend you look at the examples in the documentation for <code>alike</code> to get a sense for how <code>alike</code> works. If you want to understand the specifics, read on.</p>
</div>
<div id="templates" class="section level2">
<h2>Templates</h2>
<div id="overview" class="section level3">
<h3>Overview</h3>
<p>The basic concept behind <code>alike</code> is to allow the user to define templates to use as the <code>target</code> argument to compare against the <code>current</code> argument. Templates can specify as little or as much structure as desired, and <code>alike</code> will only compare the object against the aspects of the template that are defined. This is how we are able to define our matrix template in the introduction that only checks for the number of columns in an object.</p>
<p>One implication of this is that <code>alike</code> is not “commutative”. Compare the following to our previous examples:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="kw">matrix</span>(<span class="kw">integer</span>(), <span class="dt">nrow=</span><span class="dv">3</span>), <span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">ncol=</span><span class="dv">4</span>))   <span class="co"># same as in intro</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">ncol=</span><span class="dv">4</span>), <span class="kw">matrix</span>(<span class="kw">integer</span>(), <span class="dt">nrow=</span><span class="dv">3</span>))   <span class="co"># reverse args</span></code></pre>
<pre><code>## [1] &quot;column count mismatch: expected 4, but got 0&quot;</code></pre>
<p>Our template now defines a non-zero length object so <code>current</code> must match its length.</p>
</div>
<div id="structure-wildcards" class="section level3">
<h3>Structure Wildcards</h3>
<p>In addition to zero length <code>target</code> matching any length <code>current</code>, NULL <code>target</code> will match anything at all in current:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="kw">integer</span>(), <span class="dv">1</span>:<span class="dv">10</span>)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="ot">NULL</span>, mtcars)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="kw">list</span>(), <span class="kw">list</span>(iris, mtcars))</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="kw">list</span>(<span class="ot">NULL</span>, <span class="ot">NULL</span>), <span class="kw">list</span>(iris, mtcars))</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="kw">list</span>(<span class="ot">NULL</span>, <span class="ot">NULL</span>), <span class="kw">list</span>(iris, mtcars, warpbreaks))</code></pre>
<pre><code>## [1] &quot;Length mismatch: expected 2 but got 3&quot;</code></pre>
</div>
</div>
<div id="comparison-details" class="section level2">
<h2>Comparison Details</h2>
<div id="overview-1" class="section level3">
<h3>Overview</h3>
<p><code>alike</code> will compare the internal types of objects (see <code>base::typeof</code>), their lengths, and their attributes. Generally speaking objects are considered alike if they are of the same type, length, and have identical attributes, though there are exceptions we will discuss later.</p>
<p><code>alike</code> will recurse through lists and do pairwise alikeness comparisons between the corresponding elements of the <code>target</code> and <code>current</code> lists. Among other things, this means that <code>alike</code> will compare the structures of the component vectors of <code>data.frame</code> as these are lists.</p>
</div>
<div id="length-comparison" class="section level3">
<h3>Length Comparison</h3>
<p><code>target</code> and <code>current</code> object lengths must be the same, unless the <code>target</code> object has length zero, in which case the <code>current</code> object can have any length. If your template does not need to restrict the length of an object then you would use a zero length element as the <code>target</code> object. Note the implication here is that you cannot create a template that requires the <code>current</code> object to have length zero, but this should be a rare requirement.</p>
</div>
<div id="type-comparison" class="section level3">
<h3>Type Comparison</h3>
<p>Type comparison is done as if it were done using <code>typeof</code> with the notable exception that numerics and integers are treated specially. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(1L, <span class="dv">1</span>)     <span class="co"># note 1 is not integer</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(1L, <span class="fl">1.1</span>)   <span class="co"># 1.1 is not integer-like</span></code></pre>
<pre><code>## [1] &quot;Type mismatch, expected \&quot;integer-like\&quot;, but got \&quot;double\&quot;&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(<span class="fl">1.1</span>, 1L)   <span class="co"># but integers can match numerics</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<p><code>alike</code> treats integer-like numerics as integers. Additionally, integers can match numeric templates. If this is not the desired behavior you can use the <code>int.mode</code> parameter to engage a stricter comparison mode.</p>
</div>
<div id="attribute-comparison" class="section level3">
<h3>Attribute Comparison</h3>
<div id="overview-2" class="section level4">
<h4>Overview</h4>
<p>Attributes present in <code>target</code> must be present in <code>current</code>, but <code>current</code> may have additional attributes not present in <code>target</code>. The attributes that overlap must be <code>identical</code>, with some important exceptions outlined below. You can engage stricter comparison modes with the <code>attr.mode</code> parameter. Note that length zero attributes in <code>target</code> do not match arbitrary length attributes in <code>current</code>.</p>
</div>
<div id="row.names-and-names" class="section level4">
<h4><code>row.names</code> and <code>names</code></h4>
<p>If present in <code>target</code>, then must be matched exactly by the corresponding attribute in <code>current</code>, except that:</p>
<ul>
<li>zero length character values (i.e. <code>&quot;&quot;</code>) in <code>target</code> <code>names</code>/<code>row.names</code> will match any character value in the corresponding position of the <code>current</code> <code>names</code>/<code>row.names</code></li>
<li>zero length <code>target</code> attribute (i.e. <code>character(0L)</code>, contrast to above) will match any character <code>names</code>/<code>row.names</code></li>
</ul>
<p>These exceptions are necessary to allow you to partially specify names and dimensions:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># we use `structure` to circumvent default data.frame names</span>
df.tpl &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="kw">list</span>(<span class="dt">id=</span><span class="kw">integer</span>(), <span class="kw">numeric</span>(), <span class="kw">numeric</span>()), <span class="dt">class=</span><span class="st">&quot;data.frame&quot;</span>)
df.dat1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span><span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">x=</span><span class="kw">runif</span>(<span class="dv">3</span>), <span class="dt">y=</span><span class="kw">runif</span>(<span class="dv">3</span>))
df.dat2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">bogus=</span><span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">x=</span><span class="kw">runif</span>(<span class="dv">3</span>), <span class="dt">y=</span><span class="kw">runif</span>(<span class="dv">3</span>))

<span class="kw">alike</span>(df.tpl, df.dat1)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df.tpl)</code></pre>
<pre><code>## [1] &quot;id&quot; &quot;&quot;   &quot;&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df.dat1)</code></pre>
<pre><code>## [1] &quot;id&quot; &quot;x&quot;  &quot;y&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(df.tpl)</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(df.dat1)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(df.tpl, df.dat2)</code></pre>
<pre><code>## [1] &quot;`names` mismatch: mismatch at index [[1]]: expected \&quot;id\&quot;, but got \&quot;bogus\&quot;&quot;</code></pre>
</div>
<div id="dim" class="section level4">
<h4><code>dim</code></h4>
<p><code>dim</code> attributes must be identical between <code>target</code> and <code>current</code>, except that if a value of the <code>dim</code> vector is zero in <code>target</code> then the corresponding value in <code>current</code> can be any value. This is how comparisons like the following succeed:</p>
<pre class="sourceCode r"><code class="sourceCode r">mx.tpl &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">integer</span>(), <span class="dt">ncol=</span><span class="dv">3</span>);
mx.cur &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">nrow=</span><span class="dv">4</span>)
mx.cur2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">nrow=</span><span class="dv">3</span>)
<span class="kw">alike</span>(mx.tpl, mx.cur)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mx.tpl)    <span class="co"># notice the 0 for the first value in the `dim` vector</span></code></pre>
<pre><code>## [1] 0 3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mx.cur)</code></pre>
<pre><code>## [1] 4 3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(mx.tpl, mx.cur2)</code></pre>
<pre><code>## [1] &quot;column count mismatch: expected 3, but got 4&quot;</code></pre>
</div>
<div id="dimnames" class="section level4">
<h4><code>dimnames</code></h4>
<p>Must also be identical, except that if the <code>target</code> value of the <code>dimnames</code> list for a particular dimension is <code>NULL</code>, then the corresponding <code>dimnames</code> value in <code>current</code> may be anything.</p>
<p>Note that <code>dimnames</code> itself can also have a <code>names</code> attribute. If the <code>names</code> attribute to <code>dimnames</code> is specified in <code>target</code>, then it must be identical in <code>current</code>, with the exception that zero length character values (i.e. <code>&quot;&quot;</code>) in <code>target</code> will match any string in the corresponding name in <code>target</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mx.tpl &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">integer</span>(), <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="dt">row.id=</span><span class="ot">NULL</span>, <span class="kw">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;B&quot;</span>)))
mx.cur &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">255</span>, <span class="dv">12</span>), <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="dt">row.id=</span><span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">rgb=</span><span class="kw">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;B&quot;</span>)))
mx.cur2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">255</span>, <span class="dv">12</span>), <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="kw">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;B&quot;</span>)))

<span class="kw">alike</span>(mx.tpl, mx.cur)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(mx.tpl, mx.cur2)</code></pre>
<pre><code>## [1] &quot;\&quot;dimnames\&quot; _names_ mismatch: type mismatch: expected \&quot;character\&quot;, but got \&quot;NULL\&quot;&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(<span class="kw">dimnames</span>(mx.tpl))</code></pre>
<pre><code>## [1] &quot;row.id&quot; &quot;&quot;</code></pre>
</div>
<div id="class" class="section level4">
<h4><code>class</code></h4>
<p>S3 objects are considered alike if the <code>current</code> class inherits from the <code>target</code> class. Note that “inheritance” here is used in a stricter context than in the typical S3 application:</p>
<ul>
<li>Every class present in <code>target</code> must be present in <code>current</code></li>
<li>The overlapping classes must be in the same order</li>
<li>The last class in <code>current</code> must be the same as the last class in <code>target</code></li>
</ul>
<p>To illustrate:</p>
<pre class="sourceCode r"><code class="sourceCode r">tpl &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="ot">NULL</span>, <span class="dt">class=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))
cur &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="ot">NULL</span>, <span class="dt">class=</span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))
cur2 &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="ot">NULL</span>, <span class="dt">class=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;x&quot;</span>))

<span class="kw">alike</span>(tpl, cur)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">alike</span>(tpl, cur2)</code></pre>
<pre><code>## [1] &quot;\&quot;class\&quot; mismatch at class element #2: expected \&quot;a\&quot;, but got \&quot;b\&quot;&quot;</code></pre>
</div>
<div id="s4-and-reference-class-r5-objects" class="section level4">
<h4>S4 and Reference Class (R5) Objects</h4>
<p>S4 and RC objects are considered alike if <code>current</code> inherits from <code>class(target)</code>.</p>
</div>
<div id="reference-objects" class="section level4">
<h4>Reference Objects</h4>
<p>Attributes containing objects of the following types are actually references to specific memory locations and as such are treated specially:</p>
<ul>
<li>Environments</li>
<li>External Pointers</li>
<li>Weak References</li>
<li>Byte codes</li>
</ul>
<p>Because <code>identical</code> will return <code>FALSE</code> if the objects don’t point to the same memory location, even if they are technically equivalent, we only require that <code>target</code> and <code>current</code> be of the same type in order to meet the <code>alike</code> requirements. This isn’t ideal, but should lead to reasonable results in most circumstances.</p>
<p>If you want these attributes to be comapred with <code>identical</code> set <code>attr.mode</code> to 1 or 2.</p>
</div>
</div>
</div>
<div id="objects-that-might-be-treated-differently-in-future" class="section level2">
<h2>Objects That Might Be Treated Differently in Future</h2>
<p>The following object types are not handled specially by alike, but might be in the future:</p>
<ul>
<li>Language objects (calls)</li>
<li>Expressions</li>
<li>Formulas</li>
</ul>
<p>Currently they are compared purely on length and internal type.</p>
</div>
<div id="alike-as-an-s3-generic" class="section level2">
<h2><code>alike</code> as an S3 generic</h2>
<p><code>alike</code> is not currently an S3 generic, but will likely become one in the future provided we can create an implementation with and acceptable perforance profile.</p>
</div>
<div id="performance-considerations" class="section level2">
<h2>Performance Considerations</h2>
<div id="overview-3" class="section level3">
<h3>Overview</h3>
<p><code>alike</code> is implemented in C and is relatively fast:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
<span class="kw">microbenchmark</span>(
  <span class="kw">all.equal</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>),
  <span class="kw">identical</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>),
  <span class="kw">alike</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>),
  <span class="kw">all.equal</span>(mtcars, mtcars),
  <span class="kw">identical</span>(mtcars, mtcars),
  <span class="kw">alike</span>(mtcars, mtcars)
)</code></pre>
<pre><code>## Unit: nanoseconds
##                       expr    min     lq median     uq     max neval
##      all.equal(1:10, 1:10)  21945  24338  25604  27276   94753   100
##      identical(1:10, 1:10)   1151   1862   2246   2636   12987   100
##          alike(1:10, 1:10)   1580   2173   2754   3679   13082   100
##  all.equal(mtcars, mtcars) 388978 405696 418759 444970 1197157   100
##  identical(mtcars, mtcars)    912   1432   1710   2004   13286   100
##      alike(mtcars, mtcars)  14152  14898  15809  16879   40937   100</code></pre>
<p><code>identical</code> will pull ahead with more complex objects, but <code>alike</code> should remain substantially faster than <code>all.equal</code>.</p>
</div>
<div id="alike" class="section level3">
<h3><code>.alike</code></h3>
<p><code>.alike</code> does not accept any parameters outside of <code>target</code> and <code>current</code>, but as a result is slightly faster than <code>alike</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
<span class="kw">microbenchmark</span>(
  <span class="kw">alike</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>),
  <span class="kw">.alike</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>)
)</code></pre>
<pre><code>## Unit: microseconds
##                expr   min    lq median    uq   max neval
##   alike(1:10, 1:10) 3.275 3.454  3.735 4.054 41.98   100
##  .alike(1:10, 1:10) 2.493 2.659  2.809 3.025 36.59   100</code></pre>
<p>You should use <code>.alike</code> if you don’t require access to the other <code>alike</code> parameters and if you’re looking to minimize overhead, but keep in mind the difference is pretty small.</p>
</div>
<div id="pre-defining-templates" class="section level3">
<h3>Pre-defining Templates</h3>
<p>Some fairly innocuous R expressions carry substantial overhead. Consider:</p>
<pre class="sourceCode r"><code class="sourceCode r">df.tpl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">integer</span>(), <span class="kw">numeric</span>())
df.cur &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a=</span><span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">b=</span><span class="dv">1</span>:<span class="dv">10</span> +<span class="st"> </span>.<span class="dv">1</span>)

<span class="kw">library</span>(microbenchmark)
mb &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(
  <span class="kw">alike</span>(df.tpl, df.cur),
  <span class="kw">alike</span>(<span class="kw">data.frame</span>(<span class="kw">integer</span>(), <span class="kw">numeric</span>()), df.cur)
)
<span class="kw">summary</span>(mb)[<span class="dv">1</span>:<span class="dv">4</span>]</code></pre>
<pre><code>##                                              expr     min      lq  median
## 1                           alike(df.tpl, df.cur)   3.586   4.226   4.579
## 2 alike(data.frame(integer(), numeric()), df.cur) 245.043 252.731 257.570</code></pre>
<p><code>data.frame</code> is a particularly slow constructor, but in general you are best served by defining your templates outside of your function if you want to keep things at their snappiest.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
